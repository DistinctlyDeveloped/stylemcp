<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard ‚Äì StyleMCP</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=IBM+Plex+Mono:wght@400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg-cream: #FAF8F5;
      --bg-paper: #FFFFFF;
      --bg-warm: #F5F2ED;
      --bg-dark: #1A1918;
      --bg-ink: #0D0C0B;
      --text-primary: #1A1918;
      --text-secondary: #5C5856;
      --text-tertiary: #8A8684;
      --text-inverse: #FAF8F5;
      --accent: #E85D04;
      --accent-hover: #D45003;
      --accent-soft: #FFF0E6;
      --success: #2D6A4F;
      --success-soft: #D8F3DC;
      --warning: #CC8B00;
      --warning-soft: #FFF3CD;
      --error: #9D0208;
      --error-soft: #FFE5E5;
      --info: #1D4ED8;
      --info-soft: #DBEAFE;
      --border: #E8E4DF;
      --border-strong: #D4CFC8;
      --shadow-sm: 0 1px 2px rgba(26, 25, 24, 0.04);
      --shadow-md: 0 4px 12px rgba(26, 25, 24, 0.08);
      --shadow-lg: 0 12px 40px rgba(26, 25, 24, 0.12);
      --radius-sm: 6px;
      --radius-md: 12px;
      --radius-lg: 20px;
      --font-serif: 'Instrument Serif', Georgia, serif;
      --font-sans: 'Plus Jakarta Sans', -apple-system, sans-serif;
      --font-mono: 'IBM Plex Mono', monospace;
    }

    html { -webkit-font-smoothing: antialiased; }
    body { font-family: var(--font-sans); background: var(--bg-cream); color: var(--text-primary); line-height: 1.6; min-height: 100vh; }

    .layout { display: flex; min-height: 100vh; }

    /* Sidebar */
    .sidebar {
      width: 260px;
      background: var(--bg-paper);
      border-right: 1px solid var(--border);
      padding: 24px;
      position: fixed;
      height: 100vh;
      display: flex;
      flex-direction: column;
      z-index: 50;
    }

    .sidebar-header { margin-bottom: 32px; }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: var(--text-primary);
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      background: var(--bg-dark);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-serif);
      font-size: 22px;
      font-style: italic;
      color: var(--text-inverse);
    }

    .sidebar-logo span {
      font-weight: 600;
      font-size: 17px;
      letter-spacing: -0.02em;
    }

    .nav-section { margin-bottom: 28px; }

    .nav-label {
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-tertiary);
      padding: 0 12px;
      margin-bottom: 10px;
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 11px 12px;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      border-radius: var(--radius-md);
      margin-bottom: 4px;
      transition: all 0.2s;
      position: relative;
    }

    .nav-link:hover {
      background: var(--bg-warm);
      color: var(--text-primary);
    }

    .nav-link.active {
      background: var(--accent-soft);
      color: var(--accent);
    }

    .nav-link.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 20px;
      background: var(--accent);
      border-radius: 0 2px 2px 0;
    }

    .nav-link svg { width: 18px; height: 18px; flex-shrink: 0; }

    .sidebar-footer {
      margin-top: auto;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }

    .user-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px;
      background: var(--bg-warm);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      margin-bottom: 12px;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      background: var(--accent);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 16px;
      color: var(--text-inverse);
    }

    .user-info { flex: 1; min-width: 0; }
    .user-name { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .user-email { font-size: 12px; color: var(--text-tertiary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    .btn-logout {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 11px 16px;
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text-secondary);
      border-radius: var(--radius-md);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-logout:hover { background: var(--bg-warm); border-color: var(--border-strong); color: var(--text-primary); }
    .btn-logout svg { width: 16px; height: 16px; }

    /* Main */
    .main {
      flex: 1;
      margin-left: 260px;
      padding: 32px 48px;
      min-height: 100vh;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 32px;
    }

    .page-header h1 {
      font-family: var(--font-serif);
      font-size: 32px;
      font-weight: 400;
      margin-bottom: 6px;
    }

    .page-header p { color: var(--text-secondary); font-size: 15px; }

    .header-actions { display: flex; gap: 12px; }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 11px 20px;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 14px;
      text-decoration: none;
      transition: all 0.2s;
      cursor: pointer;
      border: none;
    }

    .btn svg { width: 16px; height: 16px; }

    .btn-primary {
      background: var(--bg-dark);
      color: var(--text-inverse);
    }

    .btn-primary:hover {
      background: var(--accent);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn-secondary {
      background: var(--bg-paper);
      color: var(--text-primary);
      border: 1px solid var(--border-strong);
    }

    .btn-secondary:hover {
      background: var(--bg-warm);
      border-color: var(--text-tertiary);
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-secondary);
      padding: 8px;
      border-radius: var(--radius-sm);
    }

    .btn-ghost:hover { background: var(--bg-warm); color: var(--text-primary); }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: var(--bg-paper);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 24px;
      transition: all 0.2s;
    }

    .stat-card:hover { border-color: var(--border-strong); box-shadow: var(--shadow-sm); }

    .stat-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }

    .stat-icon {
      width: 44px;
      height: 44px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-icon svg { width: 22px; height: 22px; }
    .stat-icon.accent { background: var(--accent-soft); color: var(--accent); }
    .stat-icon.success { background: var(--success-soft); color: var(--success); }
    .stat-icon.warning { background: var(--warning-soft); color: var(--warning); }
    .stat-icon.info { background: var(--info-soft); color: var(--info); }

    .stat-trend {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 50px;
    }

    .stat-trend.up { background: var(--success-soft); color: var(--success); }
    .stat-trend.down { background: var(--error-soft); color: var(--error); }

    .stat-label { font-size: 13px; color: var(--text-tertiary); margin-bottom: 6px; font-weight: 500; }

    .stat-value { font-family: var(--font-serif); font-size: 32px; font-weight: 400; margin-bottom: 4px; }

    .stat-sub { font-size: 13px; color: var(--text-tertiary); }
    .stat-sub a { color: var(--accent); text-decoration: none; }
    .stat-sub a:hover { text-decoration: underline; }

    .tier-badge {
      display: inline-block;
      padding: 4px 12px;
      font-family: var(--font-sans);
      font-size: 13px;
      font-weight: 600;
      border-radius: 50px;
      background: var(--bg-warm);
      color: var(--text-secondary);
    }

    .tier-badge.pro { background: var(--accent-soft); color: var(--accent); }
    .tier-badge.team { background: var(--info-soft); color: var(--info); }
    .tier-badge.enterprise { background: var(--bg-dark); color: var(--text-inverse); }

    .progress-container { margin-top: 12px; }

    .progress-bar {
      height: 8px;
      background: var(--bg-warm);
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--accent);
      border-radius: 10px;
      transition: width 0.5s ease;
    }

    .progress-fill.warning { background: var(--warning); }
    .progress-fill.danger { background: var(--error); }

    /* Cards */
    .card {
      background: var(--bg-paper);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      margin-bottom: 24px;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
      background: var(--bg-warm);
    }

    .card-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 15px;
      font-weight: 600;
    }

    .card-title svg { width: 18px; height: 18px; color: var(--text-tertiary); }

    .card-body { padding: 24px; }

    /* API Key */
    .api-key-container {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 20px;
      background: var(--bg-cream);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
    }

    .api-key-icon {
      width: 48px;
      height: 48px;
      background: var(--accent-soft);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      flex-shrink: 0;
    }

    .api-key-icon svg { width: 24px; height: 24px; }

    .api-key-content { flex: 1; min-width: 0; }
    .api-key-label { font-size: 12px; color: var(--text-tertiary); margin-bottom: 4px; font-weight: 500; }
    .api-key-value { font-family: var(--font-mono); font-size: 14px; color: var(--text-primary); word-break: break-all; }
    .api-key-value.masked { color: var(--text-tertiary); }

    .api-key-actions { display: flex; gap: 8px; }

    .btn-icon {
      width: 40px;
      height: 40px;
      background: var(--bg-paper);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: var(--text-secondary);
      transition: all 0.2s;
    }

    .btn-icon:hover { background: var(--bg-warm); border-color: var(--border-strong); color: var(--text-primary); }
    .btn-icon svg { width: 18px; height: 18px; }

    /* Code Block */
    .code-block {
      background: var(--bg-ink);
      border-radius: var(--radius-md);
      overflow: hidden;
    }

    .code-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.03);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }

    .code-header-left { display: flex; gap: 6px; }
    .code-dot { width: 10px; height: 10px; border-radius: 50%; }
    .code-dot.red { background: #FF5F57; }
    .code-dot.yellow { background: #FEBC2E; }
    .code-dot.green { background: #28C840; }
    .code-label { font-family: var(--font-mono); font-size: 11px; color: rgba(255, 255, 255, 0.4); }

    .code-body {
      padding: 20px;
      font-family: var(--font-mono);
      font-size: 13px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.85);
      overflow-x: auto;
    }

    .code-body pre { margin: 0; }
    .code-body .comment { color: #6b7280; }
    .code-body .string { color: #98C379; }

    /* Onboarding */
    .onboarding-card {
      background: var(--bg-paper);
      border: 2px solid var(--accent);
      border-radius: var(--radius-lg);
      margin-bottom: 32px;
      position: relative;
      overflow: hidden;
    }

    .onboarding-progress {
      height: 4px;
      background: var(--bg-warm);
    }

    .onboarding-progress-fill {
      height: 100%;
      background: var(--accent);
      transition: width 0.5s ease;
    }

    .onboarding-dismiss {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 28px;
      height: 28px;
      background: var(--bg-warm);
      border: none;
      border-radius: var(--radius-sm);
      color: var(--text-tertiary);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .onboarding-dismiss:hover { background: var(--border); color: var(--text-primary); }

    .onboarding-header { padding: 20px 24px 16px; }
    .onboarding-header h3 { font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
    .onboarding-header h3 span { font-size: 13px; color: var(--text-tertiary); font-weight: 500; }

    .onboarding-steps { padding: 0 16px; }

    .onboarding-step {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s;
    }

    .onboarding-step:hover { background: var(--bg-warm); }

    .step-indicator {
      width: 32px;
      height: 32px;
      background: var(--bg-warm);
      border: 2px solid var(--border);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-tertiary);
      flex-shrink: 0;
    }

    .onboarding-step.completed .step-indicator {
      background: var(--success);
      border-color: var(--success);
      color: var(--text-inverse);
    }

    .onboarding-step.completed .step-indicator span { display: none; }
    .onboarding-step.completed .step-indicator::after { content: '‚úì'; font-size: 14px; }

    .step-content { flex: 1; }
    .step-title { font-weight: 500; font-size: 14px; margin-bottom: 2px; }
    .step-desc { font-size: 13px; color: var(--text-tertiary); }

    .step-arrow { color: var(--text-tertiary); opacity: 0; transition: all 0.2s; }
    .onboarding-step:hover .step-arrow { opacity: 1; transform: translateX(4px); }
    .onboarding-step.completed .step-arrow { display: none; }

    .onboarding-cta {
      display: block;
      width: calc(100% - 32px);
      margin: 8px 16px 16px;
      padding: 14px 24px;
      background: var(--bg-dark);
      color: var(--text-inverse);
      border: none;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .onboarding-cta:hover { background: var(--accent); }

    /* Modal */
    .modal {
      position: fixed;
      inset: 0;
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .modal.hidden { display: none; }

    .modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(26, 25, 24, 0.6);
      backdrop-filter: blur(8px);
    }

    .modal-content {
      position: relative;
      background: var(--bg-paper);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 48px;
      max-width: 520px;
      width: 100%;
      text-align: center;
      box-shadow: var(--shadow-lg);
      animation: modalIn 0.3s ease;
    }

    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.95) translateY(10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      background: var(--bg-warm);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text-tertiary);
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .modal-close:hover { background: var(--border); color: var(--text-primary); }

    .modal-icon {
      width: 72px;
      height: 72px;
      background: var(--accent-soft);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      margin: 0 auto 24px;
    }

    .modal-content h2 {
      font-family: var(--font-serif);
      font-size: 28px;
      font-weight: 400;
      margin-bottom: 8px;
    }

    .modal-content > p { color: var(--text-secondary); margin-bottom: 32px; font-size: 15px; }

    .goal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

    .goal-btn {
      background: var(--bg-cream);
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      padding: 20px;
      text-align: left;
      cursor: pointer;
      transition: all 0.2s;
    }

    .goal-btn:hover { border-color: var(--accent); background: var(--accent-soft); }
    .goal-btn.selected { border-color: var(--accent); background: var(--accent-soft); }

    .goal-emoji { font-size: 28px; display: block; margin-bottom: 10px; }
    .goal-title { display: block; font-weight: 600; font-size: 14px; margin-bottom: 4px; }
    .goal-desc { display: block; font-size: 12px; color: var(--text-tertiary); }

    /* Loading */
    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60vh;
      gap: 16px;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-text { color: var(--text-tertiary); font-size: 14px; }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      padding: 14px 20px;
      background: var(--bg-paper);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      box-shadow: var(--shadow-lg);
      animation: toastIn 0.3s ease;
      z-index: 300;
    }

    .toast.success { border-color: var(--success); }
    .toast.success .toast-icon { color: var(--success); }

    @keyframes toastIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Responsive */
    @media (max-width: 1200px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }

    @media (max-width: 768px) {
      .sidebar { display: none; }
      .main { margin-left: 0; padding: 24px; }
      .stats-grid { grid-template-columns: 1fr; }
      .page-header { flex-direction: column; gap: 16px; }
      .header-actions { width: 100%; }
      .header-actions .btn { flex: 1; }
      .goal-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="layout">
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="/" class="sidebar-logo">
          <div class="logo-icon">S</div>
          <span>StyleMCP</span>
        </a>
      </div>

      <div class="nav-section">
        <div class="nav-label">Overview</div>
        <a href="/dashboard.html" class="nav-link active">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/></svg>
          Dashboard
        </a>
        <a href="/docs.html" class="nav-link">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
          Documentation
        </a>
      </div>

      <div class="nav-section">
        <div class="nav-label">Account</div>
        <a href="/pricing.html" class="nav-link">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
          Billing
        </a>
        <a href="/status.html" class="nav-link">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
          API Status
        </a>
      </div>

      <div class="sidebar-footer">
        <div class="user-card">
          <div class="user-avatar" id="userAvatar">?</div>
          <div class="user-info">
            <div class="user-name" id="userName">Loading...</div>
            <div class="user-email" id="userEmail">...</div>
          </div>
        </div>
        <button class="btn-logout" id="logoutBtn">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
          Sign Out
        </button>
      </div>
    </nav>

    <main class="main">
      <div id="loading" class="loading">
        <div class="spinner"></div>
        <div class="loading-text">Loading dashboard...</div>
      </div>

      <!-- Welcome Modal -->
      <div id="welcomeModal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
          <button class="modal-close" onclick="dismissWelcome()">&times;</button>
          <div class="modal-icon">‚ú®</div>
          <h2>Welcome to StyleMCP!</h2>
          <p>Let's personalize your experience. What brings you here today?</p>
          <div class="goal-grid">
            <button class="goal-btn" onclick="selectGoal('ai-agents')">
              <span class="goal-emoji">ü§ñ</span>
              <span class="goal-title">AI Agents</span>
              <span class="goal-desc">Keep agent outputs on-brand</span>
            </button>
            <button class="goal-btn" onclick="selectGoal('content-team')">
              <span class="goal-emoji">‚úçÔ∏è</span>
              <span class="goal-title">Content Team</span>
              <span class="goal-desc">Enforce style guide rules</span>
            </button>
            <button class="goal-btn" onclick="selectGoal('developer')">
              <span class="goal-emoji">üíª</span>
              <span class="goal-title">Developer</span>
              <span class="goal-desc">Integrate brand validation</span>
            </button>
            <button class="goal-btn" onclick="selectGoal('explore')">
              <span class="goal-emoji">üîç</span>
              <span class="goal-title">Just Exploring</span>
              <span class="goal-desc">See what StyleMCP can do</span>
            </button>
          </div>
        </div>
      </div>

      <div id="dashboard" style="display:none">
        <!-- Onboarding Checklist -->
        <div id="onboardingChecklist" class="onboarding-card">
          <div class="onboarding-progress">
            <div class="onboarding-progress-fill" id="progressFill" style="width:0%"></div>
          </div>
          <button class="onboarding-dismiss" onclick="dismissChecklist()">&times;</button>
          <div class="onboarding-header">
            <h3>üöÄ Getting Started <span id="checklistProgress">0/4 complete</span></h3>
          </div>
          <div class="onboarding-steps">
            <div class="onboarding-step" id="step1" onclick="goToStep(1)">
              <div class="step-indicator"><span>1</span></div>
              <div class="step-content">
                <div class="step-title">Copy your API key</div>
                <div class="step-desc">You'll need this to make requests</div>
              </div>
              <div class="step-arrow">‚Üí</div>
            </div>
            <div class="onboarding-step" id="step2" onclick="goToStep(2)">
              <div class="step-indicator"><span>2</span></div>
              <div class="step-content">
                <div class="step-title">Make your first API call</div>
                <div class="step-desc">Try the validation endpoint</div>
              </div>
              <div class="step-arrow">‚Üí</div>
            </div>
            <div class="onboarding-step" id="step3" onclick="goToStep(3)">
              <div class="step-indicator"><span>3</span></div>
              <div class="step-content">
                <div class="step-title">Explore style packs</div>
                <div class="step-desc">See available brand rules</div>
              </div>
              <div class="step-arrow">‚Üí</div>
            </div>
            <div class="onboarding-step" id="step4" onclick="goToStep(4)">
              <div class="step-indicator"><span>4</span></div>
              <div class="step-content">
                <div class="step-title">Read the documentation</div>
                <div class="step-desc">Learn all the features</div>
              </div>
              <div class="step-arrow">‚Üí</div>
            </div>
          </div>
          <button class="onboarding-cta" id="nextStepBtn" onclick="goToNextStep()">Copy API Key ‚Üí</button>
        </div>

        <div class="page-header">
          <div class="page-header-content">
            <h1>Dashboard</h1>
            <p>Monitor your API usage and manage your StyleMCP account</p>
          </div>
          <div class="header-actions">
            <a href="/docs.html" class="btn btn-secondary">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/></svg>
              View Docs
            </a>
            <a href="/pricing.html" class="btn btn-primary">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
              Upgrade
            </a>
          </div>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon accent">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/></svg>
              </div>
            </div>
            <div class="stat-label">Current Plan</div>
            <div class="stat-value"><span class="tier-badge" id="tierBadge">Free</span></div>
            <div class="stat-sub" id="planActions"><a href="/pricing.html">Upgrade plan ‚Üí</a></div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon info">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"/></svg>
              </div>
              <div class="stat-trend up">
                <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/></svg>
                12%
              </div>
            </div>
            <div class="stat-label">Requests This Month</div>
            <div class="stat-value" id="usedCount">0</div>
            <div class="stat-sub">of <span id="limitCount">1,000</span> included</div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon success">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
              </div>
            </div>
            <div class="stat-label">Remaining</div>
            <div class="stat-value" id="remainingCount" style="color:var(--success)">1,000</div>
            <div class="stat-sub">Resets <span id="resetDate">Feb 1</span></div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon warning">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"/></svg>
              </div>
            </div>
            <div class="stat-label">Usage</div>
            <div class="stat-value" id="usagePercent">0%</div>
            <div class="progress-container">
              <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width:0%"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/></svg>
              API Key
            </div>
            <button class="btn btn-secondary" id="regenerateBtn" style="display:none">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
              Regenerate
            </button>
          </div>
          <div class="card-body">
            <div class="api-key-container">
              <div class="api-key-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/></svg>
              </div>
              <div class="api-key-content">
                <div class="api-key-label">Your secret API key</div>
                <div class="api-key-value masked" id="apiKey">sk_‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
              </div>
              <div class="api-key-actions">
                <button class="btn-icon" id="toggleKeyBtn" title="Show/Hide">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
                </button>
                <button class="btn-icon" id="copyKeyBtn" title="Copy to clipboard">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
                </button>
              </div>
            </div>
            <p style="margin-top:16px;color:var(--text-secondary);font-size:14px">
              Include this key in your API requests using the <code style="background:var(--bg-warm);padding:3px 8px;border-radius:4px;font-family:var(--font-mono);font-size:13px">X-Api-Key</code> header.
            </p>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
              Quick Start
            </div>
          </div>
          <div class="card-body">
            <p style="color:var(--text-secondary);margin-bottom:16px;font-size:14px">Make your first API call to validate content against brand rules:</p>
            <div class="code-block">
              <div class="code-header">
                <div class="code-header-left">
                  <span class="code-dot red"></span>
                  <span class="code-dot yellow"></span>
                  <span class="code-dot green"></span>
                </div>
                <span class="code-label">Terminal</span>
              </div>
              <div class="code-body">
<pre><span class="comment"># Validate content against brand rules</span>
curl -X POST https://stylemcp.com/api/validate \
  -H <span class="string">"Content-Type: application/json"</span> \
  -H <span class="string">"X-Api-Key: <span id="curlApiKey">YOUR_API_KEY</span>"</span> \
  -d <span class="string">'{"text": "Click here to learn more!"}'</span></pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    const SUPABASE_URL = 'https://db-stylemcp.distinctlydeveloped.com';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.eyJyb2xlIjogImFub24iLCAiaXNzIjogInN1cGFiYXNlIiwgImlhdCI6IDE2NDE3NjkyMDAsICJleHAiOiAxNzk5NTM1NjAwfQ.C5ZAjtvxiiong_h_9ZOeqEm8azmucqi_SVUJP3HSl0U';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let currentUser = null;
    let userProfile = null;
    let apiKeyVisible = false;

    function showToast(message, type = 'success') {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `<span class="toast-icon">${type === 'success' ? '‚úì' : '!'}</span><span>${message}</span>`;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    async function init() {
      const { data: { session } } = await supabase.auth.getSession();
      if (!session) { window.location.href = '/login.html'; return; }
      currentUser = session.user;
      await loadProfile();
      await loadUsage();
      document.getElementById('loading').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
    }

    async function loadProfile() {
      const { data, error } = await supabase.from('profiles').select('*').eq('id', currentUser.id).single();
      if (error) { console.error('Error loading profile:', error); return; }
      userProfile = data;
      const email = currentUser.email;
      const name = email.split('@')[0];
      document.getElementById('userName').textContent = name.charAt(0).toUpperCase() + name.slice(1);
      document.getElementById('userEmail').textContent = email;
      document.getElementById('userAvatar').textContent = email.charAt(0).toUpperCase();
      const tierBadge = document.getElementById('tierBadge');
      tierBadge.textContent = data.tier.charAt(0).toUpperCase() + data.tier.slice(1);
      tierBadge.className = `tier-badge ${data.tier}`;
      document.getElementById('limitCount').textContent = data.monthly_request_limit.toLocaleString();
    }

    async function loadUsage() {
      const { data, error } = await supabase.rpc('get_usage_stats', { p_user_id: currentUser.id });
      if (error) { console.error('Error loading usage:', error); return; }
      const used = data.used || 0;
      const limit = data.limit || 1000;
      const remaining = data.remaining || limit;
      const percent = Math.round((used / limit) * 100);
      document.getElementById('usedCount').textContent = used.toLocaleString();
      document.getElementById('remainingCount').textContent = remaining.toLocaleString();
      document.getElementById('usagePercent').textContent = `${percent}%`;
      const progressBar = document.getElementById('progressBar');
      progressBar.style.width = `${percent}%`;
      if (percent >= 90) progressBar.classList.add('danger');
      else if (percent >= 75) progressBar.classList.add('warning');
      const resetDate = new Date(data.reset_date);
      document.getElementById('resetDate').textContent = resetDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      const remainingEl = document.getElementById('remainingCount');
      if (remaining === 0) remainingEl.style.color = 'var(--error)';
      else if (remaining < limit * 0.1) remainingEl.style.color = 'var(--warning)';
      else remainingEl.style.color = 'var(--success)';
    }

    document.getElementById('toggleKeyBtn').addEventListener('click', () => {
      apiKeyVisible = !apiKeyVisible;
      const keyEl = document.getElementById('apiKey');
      if (apiKeyVisible && userProfile?.api_key) {
        keyEl.textContent = userProfile.api_key;
        keyEl.classList.remove('masked');
      } else {
        keyEl.textContent = 'sk_‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
        keyEl.classList.add('masked');
      }
    });

    document.getElementById('copyKeyBtn').addEventListener('click', async () => {
      if (userProfile?.api_key) {
        await navigator.clipboard.writeText(userProfile.api_key);
        showToast('API key copied to clipboard');
        document.getElementById('curlApiKey').textContent = userProfile.api_key;
        markStepComplete(1);
      }
    });

    document.getElementById('logoutBtn').addEventListener('click', async () => {
      await supabase.auth.signOut();
      window.location.href = '/login.html';
    });

    function dismissWelcome() { document.getElementById('welcomeModal').classList.add('hidden'); }
    function dismissChecklist() { document.getElementById('onboardingChecklist').style.display = 'none'; localStorage.setItem('stylemcp_checklist_dismissed', 'true'); }
    function selectGoal(goal) { localStorage.setItem('stylemcp_goal', goal); dismissWelcome(); }

    function markStepComplete(stepNum) {
      const step = document.getElementById(`step${stepNum}`);
      if (step) step.classList.add('completed');
      updateProgress();
    }

    function updateProgress() {
      const steps = document.querySelectorAll('.onboarding-step');
      const completed = document.querySelectorAll('.onboarding-step.completed').length;
      document.getElementById('checklistProgress').textContent = `${completed}/${steps.length} complete`;
      document.getElementById('progressFill').style.width = `${(completed / steps.length) * 100}%`;
    }

    function goToStep(stepNum) {
      if (stepNum === 1) document.getElementById('copyKeyBtn').click();
      else if (stepNum === 2) window.open('/#demo', '_blank');
      else if (stepNum === 3) window.location.href = '/docs.html#packs';
      else if (stepNum === 4) window.location.href = '/docs.html';
    }

    function goToNextStep() {
      const steps = document.querySelectorAll('.onboarding-step:not(.completed)');
      if (steps.length > 0) {
        const stepId = steps[0].id;
        const stepNum = parseInt(stepId.replace('step', ''));
        goToStep(stepNum);
      }
    }

    init();
  </script>
</body>
</html>
